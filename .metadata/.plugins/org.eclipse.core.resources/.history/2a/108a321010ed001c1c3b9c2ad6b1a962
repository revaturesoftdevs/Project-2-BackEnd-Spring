package com.group5devs.project2.dao;
import com.group5devs.project2.pojo.*;
import com.group5devs.project2.entity.EmployeeEntity;
import com.group5devs.project2.entity.ManagerEntity;
import com.group5devs.project2.entity.ReimbursementEntity;
import com.group5devs.project2.exceptions.*;
import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import org.springframework.stereotype.Component;
import org.springframework.stereotype.Repository;



@Component
@Repository
public interface ManagerDao  extends JpaRepository<ManagerEntity, Integer>{
	
	
	@Query("select u from ManagerEntity u where u.mgrUserName=:username and u.mgrPassword=:password")
	ManagerEntity findByMgrUserNameAndMgrPassword(@Param("username")String username, @Param("password")String password);
	
	
	@Query("SELECT u FROM ReimbursementEntity u  WHERE u.reimbursmentStatus='pending' AND u.mgrId=:mgrId", nativeQuery = true)
	List <ReimbursementEntity> findAllPendingReimbursementStatusAndMgrId(@Param("mgrId")int mgrId);

	@Query(value = "SELECT * FROM reimbursment_details WHERE (mgr_id=?1)   AND (reimbursment_status= 'denied' or reimbursment_status= 'approved')", nativeQuery = true)
	List<ReimbursementEntity> findAllResolvedReimbursementStatusAndMgrId(int mgrId);

	@Query("select u from ReimbursementEntity u where u.mgrId=:mgrId and u.empId=:empId")
	List<ReimbursementEntity> findAllByMgrIdAndEmpId(@Param("mgrId")int mgrId,@Param("empId")int empId);
//	@Query("select u from User u where u.firstname = :firstname or u.lastname = :lastname")
//	  User findByLastnameOrFirstname(@Param("lastname") String lastname,
//	                                 @Param("firstname") String firstname);
//	}
	List<EmployeeEntity> findAllByMgrId(int mgrId);

	@Query("update ReimbursementEntity set reimbursment_status = 'approved' where emp_id =:empId AND reimbursment_id=:reimbursementId")
	boolean approveReimbursement(@Param("empId") int empId, @Param("reimbursementId")int reimbursementId); 
	
//	ManagerPojo Login(ManagerPojo managerPojo) throws SystemException;
//	
//	List<ReimbursementPojo> viewAllPendingReimbursements(int mgrId) throws SystemException;
//	
//	List<ReimbursementPojo> viewAllResolvedReimbursements(int mgrId) throws SystemException;
//	
//	List<ReimbursementPojo> viewIndividualReimbursement(int mgrId, int empId) throws SystemException;
//	
//	List<EmployeePojo> viewAllEmployees(int mgrId) throws SystemException;
//	
//	boolean approveReimbursement(int empId,int reimbursementId) throws SystemException;
//	
//	boolean denyReimbursement(int empId,int reimbursementId) throws SystemException;

}